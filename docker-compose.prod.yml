services:
  postgres:
    volumes:
      - pgdata:/var/lib/postgresql/data
    restart: always
    deploy:
      resources:
        limits:
          memory: 1G

  redis:
    volumes:
      - redisdata:/data
    restart: always
    deploy:
      resources:
        limits:
          memory: 512M

  rabbitmq:
    volumes:
      - rabbitmqdata:/var/lib/rabbitmq
    restart: always
    deploy:
      resources:
        limits:
          memory: 512M

  vault:
    restart: always
    deploy:
      resources:
        limits:
          memory: 256M

  registry:
    restart: always

  gateway:
    restart: always

  bap:
    restart: always

  bpp:
    restart: always

  admin:
    restart: always

  docs:
    restart: always

  orchestrator:
    restart: always

  health-monitor:
    restart: always

  log-aggregator:
    restart: always

  nginx:
    restart: always

  # Disable simulation services in production
  mock-server:
    profiles:
      - disabled

  simulation-engine:
    profiles:
      - disabled

volumes:
  pgdata:
  redisdata:
  rabbitmqdata:
